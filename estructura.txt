================================================================================
                    SISTEMA SEMAVENCA - MAPEO COMPLETO DE ESTRUCTURA
                          EvaluaciÃ³n de Proyectos de InversiÃ³n
================================================================================

ESTRUCTURA DE DIRECTORIOS:
â”œâ”€â”€ main_app.py                    [ARCHIVO PRINCIPAL]
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ financial_calculations.py [CÃLCULOS FINANCIEROS]
â”‚   â”œâ”€â”€ data_processing.py        [PROCESAMIENTO DE DATOS]
â”‚   â”œâ”€â”€ visualizations.py         [VISUALIZACIONES]
â”‚   â”œâ”€â”€ reports.py                [GENERACIÃ“N DE REPORTES]
â”‚   â””â”€â”€ utils.py                  [UTILIDADES Y FUNCIONES AUXILIARES]
â”œâ”€â”€ assets/
â”‚   â””â”€â”€ style.css                 [ESTILOS CSS PERSONALIZADOS]
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ ejemplos/
â”‚   â””â”€â”€ templates/
â””â”€â”€ requirements.txt              [DEPENDENCIAS]

================================================================================
                             ARCHIVO PRINCIPAL
================================================================================

main_app.py
â”œâ”€â”€ IMPORTACIONES:
â”‚   â”œâ”€â”€ streamlit as st
â”‚   â”œâ”€â”€ pandas as pd
â”‚   â”œâ”€â”€ numpy as np
â”‚   â”œâ”€â”€ datetime, warnings, sys, os, chardet, pathlib, traceback
â”‚   â””â”€â”€ modules.*
â”‚
â”œâ”€â”€ FUNCIONES PRINCIPALES:
â”‚   â”œâ”€â”€ load_css()                     â†’ Carga estilos CSS personalizados
â”‚   â”œâ”€â”€ main()                         â†’ FunciÃ³n principal de la aplicaciÃ³n
â”‚   â”œâ”€â”€ mostrar_inicio()               â†’ PÃ¡gina de inicio con informaciÃ³n
â”‚   â”œâ”€â”€ configuracion_financiera()     â†’ SecciÃ³n de configuraciÃ³n completa
â”‚   â”œâ”€â”€ mostrar_analisis()             â†’ AnÃ¡lisis financiero detallado
â”‚   â”œâ”€â”€ mostrar_visualizaciones()      â†’ Todas las visualizaciones
â”‚   â””â”€â”€ generar_reportes()             â†’ GeneraciÃ³n y descarga de reportes
â”‚
â”œâ”€â”€ FUNCIONES DE CONFIGURACIÃ“N:
â”‚   â”œâ”€â”€ configurar_inversion_inicial() â†’ InversiÃ³n y fase preoperativa
â”‚   â”œâ”€â”€ configurar_ingresos()          â†’ ParÃ¡metros de ingresos operativos
â”‚   â”œâ”€â”€ configurar_egresos()           â†’ ConfiguraciÃ³n de egresos operativos
â”‚   â””â”€â”€ generar_proyeccion_completa()  â†’ ProyecciÃ³n completa del proyecto
â”‚
â”œâ”€â”€ FUNCIONES DE ANÃLISIS:
â”‚   â”œâ”€â”€ mostrar_indicadores_principales() â†’ TIR, VPN, ROI, viabilidad
â”‚   â”œâ”€â”€ mostrar_analisis_sensibilidad()   â†’ Configurar anÃ¡lisis sensibilidad
â”‚   â”œâ”€â”€ mostrar_analisis_escenarios()     â†’ ComparaciÃ³n de escenarios
â”‚   â””â”€â”€ mostrar_analisis_detallado()      â†’ EstadÃ­sticas detalladas
â”‚
â”œâ”€â”€ FUNCIONES AUXILIARES:
â”‚   â””â”€â”€ cargar_archivo_excel_mejorado()   â†’ ValidaciÃ³n estricta de Excel
â”‚
â””â”€â”€ VARIABLES GLOBALES:
    â”œâ”€â”€ current_dir                    â†’ Directorio actual del archivo
    â”œâ”€â”€ MODULES_LOADED                 â†’ Estado de carga de mÃ³dulos
    â””â”€â”€ session_state variables       â†’ Estado de sesiÃ³n de Streamlit

================================================================================
                          MÃ“DULO: financial_calculations.py
================================================================================

CLASE PRINCIPAL:
ProyectoInversion
â”œâ”€â”€ ATRIBUTOS DE INSTANCIA:
â”‚   â”œâ”€â”€ inversion_inicial: float           â†’ Monto de inversiÃ³n inicial
â”‚   â”œâ”€â”€ meses_preoperativos: int          â†’ PerÃ­odo preoperativo
â”‚   â”œâ”€â”€ distribucion_preoperativa: Dict   â†’ DistribuciÃ³n mensual preoperativa
â”‚   â”œâ”€â”€ saldos_preoperativos: List        â†’ Saldos calculados por mes
â”‚   â”œâ”€â”€ configuracion_ingresos: Dict      â†’ ParÃ¡metros de ingresos
â”‚   â”œâ”€â”€ configuracion_egresos: Dict       â†’ ParÃ¡metros de egresos
â”‚   â”œâ”€â”€ flujo_efectivo: List[float]       â†’ Flujos de efectivo mensuales
â”‚   â”œâ”€â”€ ingresos_operativos: List[float]  â†’ Ingresos operativos proyectados
â”‚   â”œâ”€â”€ egresos_operativos: List[float]   â†’ Egresos operativos proyectados
â”‚   â””â”€â”€ indicadores: Dict                 â†’ Indicadores financieros calculados
â”‚
â”œâ”€â”€ MÃ‰TODOS DE FASE PREOPERATIVA:
â”‚   â”œâ”€â”€ __init__(self)                    â†’ Constructor de la clase
â”‚   â”œâ”€â”€ calcular_saldos_preoperativos()   â†’ Saldos mensuales preoperativos
â”‚   â”œâ”€â”€ calcular_ingresos_operativos()    â†’ ProyecciÃ³n de ingresos
â”‚   â””â”€â”€ calcular_egresos_operativos()     â†’ ProyecciÃ³n de egresos
â”‚
â”œâ”€â”€ MÃ‰TODOS DE CÃLCULO FINANCIERO (EXCEL-COMPATIBLE):
â”‚   â”œâ”€â”€ _convertir_flujos_si_necesario()  â†’ Convierte flujos acumulados/perÃ­odo
â”‚   â”œâ”€â”€ _tir_excel_newton()               â†’ Newton-Raphson Excel-compatible
â”‚   â”œâ”€â”€ calcular_tir()                    â†’ TIR con metodologÃ­a exacta Excel
â”‚   â”‚   â”œâ”€â”€ ParÃ¡metros: flujos_efectivo, inversion_inicial, max_iteraciones
â”‚   â”‚   â”œâ”€â”€ Keywords: guess, devolver, periodos_por_anio, excel_compatible, input_tipo
â”‚   â”‚   â”œâ”€â”€ Algoritmo: Newton-Raphson, 20 iteraciones, tolerancia 1e-7
â”‚   â”‚   â””â”€â”€ Returns: TIR anual/perÃ­odo o None (#NUM!)
â”‚   â”œâ”€â”€ calcular_vpn()                    â†’ VPN con fÃ³rmula exacta Excel
â”‚   â”‚   â”œâ”€â”€ FÃ³rmula: Î£(Flujo_t/(1+r)^t) - InversiÃ³n
â”‚   â”‚   â”œâ”€â”€ ConversiÃ³n: Tasa anual â†’ mensual automÃ¡tica
â”‚   â”‚   â””â”€â”€ Returns: VPN en moneda base
â”‚   â”œâ”€â”€ calcular_roi()                    â†’ ROI estÃ¡ndar
â”‚   â”‚   â”œâ”€â”€ FÃ³rmula: ((Beneficio-InversiÃ³n)/InversiÃ³n)*100
â”‚   â”‚   â””â”€â”€ Returns: ROI en porcentaje
â”‚   â””â”€â”€ calcular_periodo_recuperacion()   â†’ Payback period con interpolaciÃ³n
â”‚
â”œâ”€â”€ MÃ‰TODOS DE ANÃLISIS:
â”‚   â”œâ”€â”€ analisis_sensibilidad()           â†’ AnÃ¡lisis multivariable corregido
â”‚   â”‚   â”œâ”€â”€ Input: variaciones_ingresos, variaciones_egresos, tasa_descuento
â”‚   â”‚   â”œâ”€â”€ Proceso: Matriz [egresos x ingresos] de TIR y VPN
â”‚   â”‚   â””â”€â”€ Output: {"tir_matriz", "vpn_matriz", "variaciones_ing", "variaciones_egr"}
â”‚   â””â”€â”€ validar_flujos_para_tir()         â†’ ValidaciÃ³n estilo Excel
â”‚
â””â”€â”€ MÃ‰TODOS DE DEBUG:
    â””â”€â”€ debug_tir()                       â†’ InformaciÃ³n detallada para debugging

================================================================================
                            MÃ“DULO: data_processing.py
================================================================================

CLASE PRINCIPAL:
DataProcessor
â”œâ”€â”€ ATRIBUTOS DE INSTANCIA:
â”‚   â”œâ”€â”€ datos_validados: Dict             â†’ Datos procesados y validados
â”‚   â”œâ”€â”€ errores_validacion: List[str]     â†’ Lista de errores encontrados
â”‚   â””â”€â”€ advertencias: List[str]           â†’ Lista de advertencias generadas
â”‚
â”œâ”€â”€ MÃ‰TODOS DE VALIDACIÃ“N DE EXCEL:
â”‚   â”œâ”€â”€ validar_archivo_excel()           â†’ ValidaciÃ³n completa de archivo Excel
â”‚   â”œâ”€â”€ _detectar_columnas_similares()    â†’ DetecciÃ³n automÃ¡tica de columnas
â”‚   â”œâ”€â”€ _limpiar_datos_egresos()          â†’ Limpieza y normalizaciÃ³n de datos
â”‚   â”œâ”€â”€ _consolidar_conceptos_duplicados() â†’ ConsolidaciÃ³n de conceptos duplicados
â”‚   â”œâ”€â”€ _validar_datos_egresos()          â†’ Validaciones especÃ­ficas de calidad
â”‚   â””â”€â”€ _filtrar_datos_validos()          â†’ Filtrado de datos vÃ¡lidos Ãºnicamente
â”‚
â”œâ”€â”€ MÃ‰TODOS DE DISTRIBUCIÃ“N TEMPORAL:
â”‚   â”œâ”€â”€ generar_distribucion_temporal()   â†’ DistribuciÃ³n de montos en el tiempo
â”‚   â”‚   â”œâ”€â”€ Tipos: "uniforme", "creciente", "decreciente", "exponencial", "estacional"
â”‚   â”‚   â””â”€â”€ Returns: Dict[mes, monto]
â”‚   â”œâ”€â”€ _generar_factores_estacionales()  â†’ Factores estacionales con funciÃ³n seno
â”‚   â””â”€â”€ proyectar_serie_temporal()        â†’ ProyecciÃ³n con crecimiento y volatilidad
â”‚       â”œâ”€â”€ Tendencias: "lineal", "exponencial", "logistica"
â”‚       â””â”€â”€ Incluye: ruido aleatorio, semilla reproducible
â”‚
â”œâ”€â”€ MÃ‰TODOS DE ANÃLISIS ESTADÃSTICO:
â”‚   â”œâ”€â”€ calcular_metricas_serie()         â†’ MÃ©tricas estadÃ­sticas completas
â”‚   â”‚   â”œâ”€â”€ BÃ¡sicas: media, mediana, desviaciÃ³n, coef_variaciÃ³n
â”‚   â”‚   â”œâ”€â”€ Avanzadas: asimetrÃ­a, curtosis, tasa_crecimiento_promedio
â”‚   â”‚   â””â”€â”€ DistribuciÃ³n: percentiles, rango, min, max
â”‚   â”œâ”€â”€ _calcular_asimetria()             â†’ AsimetrÃ­a (con scipy o manual)
â”‚   â”œâ”€â”€ _calcular_curtosis()              â†’ Curtosis (con scipy o manual)
â”‚   â””â”€â”€ _calcular_tasa_crecimiento_promedio() â†’ Tasa geomÃ©trica de crecimiento
â”‚
â”œâ”€â”€ MÃ‰TODOS DE SIMULACIÃ“N:
â”‚   â”œâ”€â”€ generar_escenarios_monte_carlo()  â†’ SimulaciÃ³n Monte Carlo
â”‚   â”‚   â”œâ”€â”€ ParÃ¡metros: num_simulaciones (default 1000)
â”‚   â”‚   â”œâ”€â”€ Variaciones: Â±15% ingresos, Â±10% egresos, Â±5% inversiÃ³n
â”‚   â”‚   â””â”€â”€ Returns: {"tir", "vpn", "roi", "payback"}
â”‚   â””â”€â”€ limpiar_cache()                   â†’ Limpieza de cache y datos temporales
â”‚
â””â”€â”€ MÃ‰TODOS DE EXPORTACIÃ“N:
    â””â”€â”€ exportar_datos_procesados()       â†’ ExportaciÃ³n en mÃºltiples formatos
        â”œâ”€â”€ Formatos: "excel", "csv", "json"
        â””â”€â”€ Returns: bytes del archivo generado

================================================================================
                            MÃ“DULO: visualizations.py
================================================================================

FUNCIONES DE VISUALIZACIÃ“N (MATPLOTLIB):
â”œâ”€â”€ crear_dashboard_indicadores()         â†’ Dashboard principal con indicadores
â”‚   â”œâ”€â”€ Input: ProyectoInversion
â”‚   â”œâ”€â”€ GrÃ¡ficos: TIR gauge, VPN escenarios, recuperaciÃ³n inversiÃ³n
â”‚   â”œâ”€â”€ Estilos: barras horizontales, lÃ­neas con marcadores, fills
â”‚   â””â”€â”€ Returns: (fig_tir, fig_vpn, fig_recuperacion)
â”‚
â”œâ”€â”€ crear_analisis_flujo_efectivo()       â†’ AnÃ¡lisis detallado flujo efectivo
â”‚   â”œâ”€â”€ Subplots: 2x2 grid (flujos mensual, acumulado, distribuciÃ³n, volatilidad)
â”‚   â”œâ”€â”€ GrÃ¡ficos: barras apiladas, lÃ­neas, pie chart, coeficiente variaciÃ³n
â”‚   â”œâ”€â”€ Features: fill_between, grid, leyendas personalizadas
â”‚   â””â”€â”€ Returns: matplotlib.figure.Figure
â”‚
â”œâ”€â”€ crear_analisis_sensibilidad_visual()  â†’ Mapas de calor para sensibilidad
â”‚   â”œâ”€â”€ Input: resultados_sensibilidad dict
â”‚   â”œâ”€â”€ GrÃ¡ficos: 2 heatmaps (TIR y VPN) con imshow()
â”‚   â”œâ”€â”€ Features: valores en celdas, colorbars, escalas de color personalizadas
â”‚   â””â”€â”€ Returns: (fig_tir_sens, fig_vpn_sens)
â”‚
â”œâ”€â”€ crear_comparacion_escenarios()        â†’ ComparaciÃ³n de escenarios mÃºltiples
â”‚   â”œâ”€â”€ Escenarios: Pesimista (0.8/1.2), Base (1.0/1.0), Optimista (1.2/0.9)
â”‚   â”œâ”€â”€ GrÃ¡fico: lÃ­neas con marcadores, diferentes colores por escenario
â”‚   â”œâ”€â”€ Features: lÃ­nea de equilibrio, leyenda, grid
â”‚   â””â”€â”€ Returns: matplotlib.figure.Figure
â”‚
â”œâ”€â”€ crear_grafico_rentabilidad_temporal() â†’ EvoluciÃ³n temporal de rentabilidad
â”‚   â”œâ”€â”€ Subplots: 2 filas (TIR acumulada, VPN acumulado)
â”‚   â”œâ”€â”€ CÃ¡lculos: TIR simplificada mes a mes, VPN con tasa fija mensual
â”‚   â”œâ”€â”€ Features: fill_between, lÃ­neas objetivo, marcadores
â”‚   â””â”€â”€ Returns: matplotlib.figure.Figure
â”‚
â””â”€â”€ crear_resumen_ejecutivo_visual()      â†’ Dashboard ejecutivo completo
    â”œâ”€â”€ Layout: GridSpec 3x3 personalizado
    â”œâ”€â”€ Elementos: gauges circulares simulados, barras, tabla resumen
    â”œâ”€â”€ MÃ©tricas: TIR, VPN, ROI, perÃ­odo recuperaciÃ³n, estado viabilidad
    â””â”€â”€ Returns: matplotlib.figure.Figure con suptitle

CONFIGURACIONES GLOBALES:
â”œâ”€â”€ plt.style.use('default')              â†’ Estilo matplotlib por defecto
â”œâ”€â”€ sns.set_palette("husl")               â†’ Paleta de colores Seaborn
â””â”€â”€ Figsize estÃ¡ndar: (8,6) a (15,10)    â†’ TamaÃ±os optimizados para Streamlit

================================================================================
                               MÃ“DULO: utils.py
================================================================================

FUNCIONES DE INTERFAZ Y PRESENTACIÃ“N:
â”œâ”€â”€ crear_header_empresa()               â†’ Header corporativo HTML/CSS
â”œâ”€â”€ crear_tarjeta_metrica()              â†’ Tarjetas HTML estilizadas para mÃ©tricas
â”œâ”€â”€ mostrar_alerta_personalizada()      â†’ Alertas personalizadas con colores
â””â”€â”€ generar_alerta_validacion()         â†’ Alertas especÃ­ficas de validaciÃ³n

FUNCIONES DE VALIDACIÃ“N:
â”œâ”€â”€ validar_datos_entrada()             â†’ ValidaciÃ³n completa de datos proyecto
â”œâ”€â”€ validar_rango_numerico()            â†’ ValidaciÃ³n de rangos numÃ©ricos
â”œâ”€â”€ validar_archivo_subido()            â†’ ValidaciÃ³n de archivos Excel subidos
â”œâ”€â”€ validar_coherencia_flujos()         â†’ Coherencia entre ingresos/egresos
â””â”€â”€ verificar_integridad_datos()        â†’ VerificaciÃ³n integridad completa proyecto

FUNCIONES DE PROCESAMIENTO DE EXCEL:
â”œâ”€â”€ cargar_archivo_excel()              â†’ Carga y validaciÃ³n de Excel
â”œâ”€â”€ _detectar_columnas_similares()      â†’ DetecciÃ³n automÃ¡tica columnas
â”œâ”€â”€ _limpiar_datos_excel()              â†’ Limpieza segÃºn especificaciones:
â”‚   â”œâ”€â”€ Conceptos vacÃ­os â†’ "Gasto por identificar"
â”‚   â”œâ”€â”€ EliminaciÃ³n montos <= 0
â”‚   â””â”€â”€ Filtrado datos vÃ¡lidos Ãºnicamente
â””â”€â”€ exportar_dataframe_excel()          â†’ ExportaciÃ³n DataFrame a Excel

FUNCIONES DE DATOS DE EJEMPLO:
â”œâ”€â”€ generar_datos_ejemplo()             â†’ Datos financieros de ejemplo
â”‚   â””â”€â”€ Returns: Dict con inversion_inicial, multas_diarias, porcentajes, etc.
â””â”€â”€ crear_egresos_ejemplo()             â†’ DataFrame egresos operativos ejemplo
    â””â”€â”€ Returns: 14 conceptos con montos (Sueldos, servicios, etc.)

FUNCIONES DE CÃLCULOS Y ESTADÃSTICAS:
â”œâ”€â”€ calcular_estadisticas_descriptivas() â†’ EstadÃ­sticas completas de series
â”œâ”€â”€ calcular_metricas_sensibilidad()    â†’ MÃ©tricas de anÃ¡lisis sensibilidad
â”œâ”€â”€ _calcular_coeficiente_variacion()   â†’ Coeficiente variaciÃ³n de flujos
â””â”€â”€ crear_resumen_metricas()            â†’ Resumen completo mÃ©tricas proyecto

FUNCIONES DE FORMATEO:
â”œâ”€â”€ formatear_numero()                  â†’ Formateo nÃºmeros (moneda, %, nÃºmero, miles)
â”œâ”€â”€ formatear_tabla_financiera()       â†’ Formato financiero para DataFrames
â””â”€â”€ crear_tabla_comparacion()          â†’ Tablas comparativas de escenarios

FUNCIONES DE UTILIDAD GENERAL:
â”œâ”€â”€ generar_codigo_proyecto()           â†’ CÃ³digo Ãºnico proyecto (timestamp + random)
â”œâ”€â”€ mostrar_progreso_calculo()          â†’ Barra progreso para cÃ¡lculos
â”œâ”€â”€ crear_configuracion_exportacion()  â†’ ConfiguraciÃ³n para reportes
â””â”€â”€ validar_archivo_subido()            â†’ ValidaciÃ³n archivos (extensiÃ³n, tamaÃ±o)

================================================================================
                               MÃ“DULO: reports.py
================================================================================
[NOTA: Este mÃ³dulo se importa pero no se proporcionÃ³ en los archivos]

FUNCIONES ESPERADAS (basado en importaciones):
â”œâ”€â”€ generar_excel_completo()            â†’ GeneraciÃ³n reporte Excel completo
â”œâ”€â”€ generar_reporte_ejecutivo_pdf()     â†’ GeneraciÃ³n reporte PDF ejecutivo
â”œâ”€â”€ crear_boton_descarga_excel()       â†’ BotÃ³n descarga archivo Excel
â”œâ”€â”€ crear_boton_descarga_pdf()         â†’ BotÃ³n descarga archivo PDF
â””â”€â”€ generar_resumen_hallazgos()        â†’ Resumen automÃ¡tico hallazgos

================================================================================
                            FLUJO DE EJECUCIÃ“N PRINCIPAL
================================================================================

1. INICIALIZACIÃ“N:
   main() â†’ load_css() â†’ crear_header_empresa()
   
2. CONFIGURACIÃ“N SESSION_STATE:
   â”œâ”€â”€ ProyectoInversion() instance
   â”œâ”€â”€ DataProcessor() instance
   â””â”€â”€ verificar_integridad_datos()

3. NAVEGACIÃ“N PRINCIPAL (Sidebar):
   â”œâ”€â”€ "ğŸ  Inicio" â†’ mostrar_inicio()
   â”œâ”€â”€ "ğŸ’° ConfiguraciÃ³n Financiera" â†’ configuracion_financiera()
   â”œâ”€â”€ "ğŸ“Š AnÃ¡lisis" â†’ mostrar_analisis()
   â”œâ”€â”€ "ğŸ“ˆ Visualizaciones" â†’ mostrar_visualizaciones()
   â””â”€â”€ "ğŸ“„ Reportes" â†’ generar_reportes()

4. FLUJO DE CONFIGURACIÃ“N:
   configuracion_financiera() â†’ Tabs:
   â”œâ”€â”€ Tab 1: configurar_inversion_inicial()
   â”œâ”€â”€ Tab 2: configurar_ingresos()
   â”œâ”€â”€ Tab 3: configurar_egresos()
   â””â”€â”€ Tab 4: generar_proyeccion_completa() â†’ CÃLCULOS PRINCIPALES

5. FLUJO DE CÃLCULOS (generar_proyeccion_completa):
   â”œâ”€â”€ ValidaciÃ³n datos egresos
   â”œâ”€â”€ calcular_ingresos_operativos()
   â”œâ”€â”€ calcular_egresos_operativos()
   â”œâ”€â”€ CÃ¡lculo flujos efectivo (ingresos - egresos)
   â”œâ”€â”€ calcular_tir() [Excel-compatible]
   â”œâ”€â”€ calcular_vpn() [Excel-compatible]  
   â”œâ”€â”€ calcular_roi() [EstÃ¡ndar]
   â”œâ”€â”€ calcular_periodo_recuperacion()
   â””â”€â”€ Guardar en proyecto.indicadores

6. FLUJO DE ANÃLISIS:
   mostrar_analisis() â†’ Tabs:
   â”œâ”€â”€ mostrar_indicadores_principales()
   â”œâ”€â”€ mostrar_analisis_sensibilidad()
   â”œâ”€â”€ mostrar_analisis_escenarios()
   â””â”€â”€ mostrar_analisis_detallado()

7. FLUJO DE VISUALIZACIONES:
   mostrar_visualizaciones() â†’ Tabs:
   â”œâ”€â”€ crear_dashboard_indicadores()
   â”œâ”€â”€ crear_analisis_flujo_efectivo()
   â”œâ”€â”€ crear_analisis_sensibilidad_visual()
   â”œâ”€â”€ crear_comparacion_escenarios()
   â””â”€â”€ crear_resumen_ejecutivo_visual()

================================================================================
                              DEPENDENCIAS EXTERNAS
================================================================================

LIBRERÃAS PRINCIPALES:
â”œâ”€â”€ streamlit                   â†’ Framework web principal
â”œâ”€â”€ pandas                      â†’ ManipulaciÃ³n de datos y DataFrames
â”œâ”€â”€ numpy                       â†’ CÃ¡lculos numÃ©ricos y arrays
â”œâ”€â”€ matplotlib.pyplot           â†’ Visualizaciones y grÃ¡ficos
â”œâ”€â”€ seaborn                     â†’ Estilos y paletas para matplotlib
â”œâ”€â”€ datetime                    â†’ Manejo de fechas y tiempo
â”œâ”€â”€ pathlib                     â†’ Manejo de rutas de archivos
â”œâ”€â”€ io (BytesIO)               â†’ Manejo de streams en memoria
â”œâ”€â”€ warnings                    â†’ SupresiÃ³n de advertencias
â”œâ”€â”€ chardet                     â†’ DetecciÃ³n de codificaciÃ³n de archivos
â”œâ”€â”€ traceback                   â†’ InformaciÃ³n de errores detallada
â””â”€â”€ typing                      â†’ Type hints (Dict, List, Tuple, Optional, Union)

LIBRERÃAS OPCIONALES (con fallback manual):
â”œâ”€â”€ scipy.stats                 â†’ CÃ¡lculos estadÃ­sticos avanzados (asimetrÃ­a, curtosis)
â”œâ”€â”€ difflib                     â†’ DetecciÃ³n de similitudes en strings
â””â”€â”€ xlsxwriter                  â†’ Escritura avanzada de archivos Excel

ENGINES DE EXCEL:
â”œâ”€â”€ openpyxl                    â†’ Lectura/escritura archivos .xlsx
â””â”€â”€ xlrd                        â†’ Lectura archivos .xls (legacy)

================================================================================
                            ESTRUCTURA DE DATOS PRINCIPAL
================================================================================

session_state:
â”œâ”€â”€ proyecto: ProyectoInversion
â”‚   â”œâ”€â”€ inversion_inicial: float
â”‚   â”œâ”€â”€ meses_preoperativos: int
â”‚   â”œâ”€â”€ distribucion_preoperativa: Dict[int, float]
â”‚   â”œâ”€â”€ saldos_preoperativos: List[Dict]
â”‚   â”œâ”€â”€ configuracion_ingresos: Dict
â”‚   â”‚   â”œâ”€â”€ multas_diarias: float
â”‚   â”‚   â”œâ”€â”€ valor_multa_descuento: float
â”‚   â”‚   â”œâ”€â”€ pct_pago_voluntario: float
â”‚   â”‚   â”œâ”€â”€ pct_ingreso_operativo: float
â”‚   â”‚   â””â”€â”€ proyeccion: List[float]
â”‚   â”œâ”€â”€ configuracion_egresos: Dict
â”‚   â”‚   â”œâ”€â”€ egresos_base: Dict[str, float]
â”‚   â”‚   â”œâ”€â”€ total_base: float
â”‚   â”‚   â”œâ”€â”€ tasa_variacion: float
â”‚   â”‚   â””â”€â”€ detalle_mensual: List[Dict]
â”‚   â”œâ”€â”€ ingresos_operativos: List[float]
â”‚   â”œâ”€â”€ egresos_operativos: List[float]
â”‚   â”œâ”€â”€ flujo_efectivo: List[float]
â”‚   â””â”€â”€ indicadores: Dict
â”‚       â”œâ”€â”€ tir: float | None
â”‚       â”œâ”€â”€ vpn: float
â”‚       â”œâ”€â”€ roi: float
â”‚       â”œâ”€â”€ periodo_recuperacion: Dict
â”‚       â””â”€â”€ tasa_descuento: float
â”œâ”€â”€ data_processor: DataProcessor
â”œâ”€â”€ datos_ejemplo: Dict
â”œâ”€â”€ egresos_ejemplo: pd.DataFrame
â””â”€â”€ variables temporales de UI

================================================================================
                                PUNTOS DE ENTRADA
================================================================================

ARCHIVO PRINCIPAL:
python main_app.py
streamlit run main_app.py

FUNCIONES PÃšBLICAS PRINCIPALES:
â”œâ”€â”€ ProyectoInversion.calcular_tir()
â”œâ”€â”€ ProyectoInversion.calcular_vpn()
â”œâ”€â”€ ProyectoInversion.calcular_roi()
â”œâ”€â”€ ProyectoInversion.analisis_sensibilidad()
â”œâ”€â”€ DataProcessor.validar_archivo_excel()
â”œâ”€â”€ crear_dashboard_indicadores()
â””â”€â”€ todas las funciones de utils.py

================================================================================
                               CONFIGURACIONES
================================================================================

CONSTANTES PRINCIPALES:
â”œâ”€â”€ Semilla aleatoria: 42 (reproducibilidad)
â”œâ”€â”€ Tolerancia TIR: 1e-7 (Excel-compatible)
â”œâ”€â”€ Iteraciones mÃ¡ximas TIR: 20 (Excel-compatible)
â”œâ”€â”€ Guess inicial TIR: 0.10 (10%)
â”œâ”€â”€ TamaÃ±o mÃ¡ximo archivo: 10MB
â”œâ”€â”€ MÃ­nimo flujo mensual: $1,000
â”œâ”€â”€ Meses operativos: 6-120 rango vÃ¡lido
â””â”€â”€ PerÃ­odos por aÃ±o: 12 (mensual)

FORMATOS DE SALIDA:
â”œâ”€â”€ Moneda: "${:,.2f}"
â”œâ”€â”€ Porcentaje: "{:.2%}"
â”œâ”€â”€ NÃºmero: "{:,.2f}"
â””â”€â”€ CÃ³digo proyecto: "SEMAVENCA-YYYYMMDD-####"

================================================================================
                                    RESUMEN
================================================================================

TOTAL ARCHIVOS PYTHON: 6
â”œâ”€â”€ main_app.py (archivo principal)
â””â”€â”€ modules/ (5 archivos)

TOTAL CLASES: 2
â”œâ”€â”€ ProyectoInversion (financial_calculations.py)
â””â”€â”€ DataProcessor (data_processing.py)

TOTAL FUNCIONES: ~80
â”œâ”€â”€ main_app.py: ~15 funciones
â”œâ”€â”€ financial_calculations.py: ~15 mÃ©todos
â”œâ”€â”€ data_processing.py: ~20 mÃ©todos  
â”œâ”€â”€ visualizations.py: ~10 funciones
â”œâ”€â”€ utils.py: ~25 funciones
â””â”€â”€ reports.py: ~5 funciones (estimado)

METODOLOGÃAS IMPLEMENTADAS:
â”œâ”€â”€ TIR: Newton-Raphson Excel-compatible
â”œâ”€â”€ VPN: Descuento exacto con conversiÃ³n tasa
â”œâ”€â”€ ROI: FÃ³rmula estÃ¡ndar financiera
â”œâ”€â”€ Sensibilidad: AnÃ¡lisis matricial multivariable
â”œâ”€â”€ Monte Carlo: SimulaciÃ³n con 1000 iteraciones default
â””â”€â”€ VisualizaciÃ³n: matplotlib con estilos profesionales

VALIDACIONES IMPLEMENTADAS:
â”œâ”€â”€ Excel: columnas requeridas, datos vÃ¡lidos, conceptos vacÃ­os
â”œâ”€â”€ NumÃ©rica: rangos, coherencia, integridad
â”œâ”€â”€ Archivos: extensiÃ³n, tamaÃ±o, formato
â””â”€â”€ Flujos: positivos/negativos, longitud, proporciones

================================================================================